var minutes,timer;$(main);$(window).on("ontouchup","focus",function(){clearInterval(timer);main()});
function main(){var a=new Date;minutes=60*a.getHours()+a.getMinutes();var c=getDateString(a),b={};if(a.getDay()%6&&-1==constants.holidays.indexOf(c))-1!=constants.latearrival.indexOf(c)?(b=getPeriod(constants.latearrival_s,constants.latearrival_e,constants.latearrival_p),b.schedule="Late Arrival"):-1!=constants.activityperiod.indexOf(c)?(b=getPeriod(constants.activityperiod_s,constants.activityperiod_e,constants.activityperiod_p),b.schedule="Activity"):-1!=constants.pmassembly.indexOf(c)?(b=
getPeriod(constants.pmassembly_s,constants.pmassembly_e,constants.pmassembly_p),b.schedule="PM Assembly"):(b=getPeriod(constants.standard_s,constants.standard_e,constants.standard_p),b.schedule="Standard Schedule");else{b.schedule="No school";for(b.period="";!(a.getDay()%6)||-1!=constants.holidays.indexOf(c);)a.setDate(a.getDate()+1),c=getDateString(a);b.range="School resumes: "+getDateString(a,"/");b.end=!1}$("#schedule").text(b.schedule);$("#period").text(b.period);$("#range").text(b.range);var e=
60*(b.end-minutes-1)+(60-a.getSeconds()),d,a=function(){d=e%60;$("#timer").text(Math.floor(e/60)+":"+(10>d?"0"+d:d));0>=e&&(clearInterval(timer),$("#timer").text(""),main());e--};b.end&&(timer=setInterval(a,1E3),a())}
function getPeriod(a,c,b){if(minutes<a[0]||minutes>=c[c.length-1])return{period:"None",end:!1,range:""};for(var e,d=0;d<a.length;d++)if(minutes>=a[d]&&(e=d,minutes<c[d]))return{period:"Period "+b[d],end:c[d],range:toHours(a[d])+"-"+toHours(c[d])};return{period:"Passing",end:a[e+1],range:"Next: "+toHours(a[e+1])+"-"+toHours(c[e+1])}}function getDateString(a){return a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()}
function toHours(a){var c=Math.floor(a/60);12<c&&(c-=12);a%=60;10>a&&(a="0"+a);return c+":"+a};