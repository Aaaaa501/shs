var minutes,timer;$(main);$(window).on("touchend focus",function(){clearInterval(timer);main()});
function main(){var b=new Date;minutes=60*b.getHours()+b.getMinutes();var c=getDateString(b),a={};if(b.getDay()%6&&-1==constants.holidays.indexOf(c))if(-1!=constants.latearrival.indexOf(c))a=getPeriod(constants.latearrival_s,constants.latearrival_e,constants.latearrival_p),a.schedule="Late Arrival";else if(-1!=constants.activityperiod.indexOf(c))a=getPeriod(constants.activityperiod_s,constants.activityperiod_e,constants.activityperiod_p),a.schedule="Activity";else if(-1!=constants.pmassembly.indexOf(c))a=
getPeriod(constants.pmassembly_s,constants.pmassembly_e,constants.pmassembly_p),a.schedule="PM Assembly";else if(-1!=constants.finals.indexOf(c)){for(a=new Date;-1!=constants.finals.indexOf(getDateString(a));)a.setDate(a.getDate()-1);a=(new Date).getDate()-a.getDate();finals_p=1==a?constants.finals_p1:2==a?constants.finals_p2:constants.finals_p3;a=getPeriod(constants.finals_s,constants.finals_e,finals_p);a.schedule="Finals"}else a=getPeriod(constants.standard_s,constants.standard_e,constants.standard_p),
a.schedule="Standard Schedule";else{a.schedule="No school";for(a.period="!";!(b.getDay()%6)||-1!=constants.holidays.indexOf(c);)b.setDate(b.getDate()+1),c=getDateString(b);a.range="School resumes: "+getDateString(b,"/");a.end=!1}a.period="!"==a.period[0]?a.period.substring(1,a.period.length):"Period "+a.period;$("#schedule").text(a.schedule);$("#period").text(a.period);$("#range").text(a.range);var e=60*(a.end-minutes-1)+(60-b.getSeconds()),d,b=function(){d=e%60;$("#timer").text(Math.floor(e/60)+
":"+(10>d?"0"+d:d));0>=e&&(clearInterval(timer),$("#timer").text(""),main());e--};a.end&&(timer=setInterval(b,1E3),b())}function getPeriod(b,c,a){if(minutes<b[0]||minutes>=c[c.length-1])return{period:"!None",end:!1,range:""};for(var e,d=0;d<b.length;d++)if(minutes>=b[d]&&(e=d,minutes<c[d]))return{period:a[d],end:c[d],range:toHours(b[d])+"-"+toHours(c[d])};return{period:"Passing",end:b[e+1],range:"Next: "+toHours(b[e+1])+"-"+toHours(c[e+1])}}
function getDateString(b){return b.getMonth()+1+"/"+b.getDate()+"/"+b.getFullYear()}function toHours(b){var c=Math.floor(b/60);12<c&&(c-=12);b%=60;10>b&&(b="0"+b);return c+":"+b};