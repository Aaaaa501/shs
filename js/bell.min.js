function main(){var e=new Date;minutes=60*e.getHours()+e.getMinutes();var t=getDateString(e),n={};if(e.getDay()%6&&-1==constants.holidays.indexOf(t))if(-1!=constants.latearrival.indexOf(t))(n=getPeriod(constants.latearrival_s,constants.latearrival_e,constants.latearrival_p)).schedule="Late Arrival";else if(-1!=constants.activityperiod.indexOf(t))(n=getPeriod(constants.activityperiod_s,constants.activityperiod_e,constants.activityperiod_p)).schedule="Activity";else if(-1!=constants.pmassembly.indexOf(t))(n=getPeriod(constants.pmassembly_s,constants.pmassembly_e,constants.pmassembly_p)).schedule="PM Assembly";else if(-1!=constants.finals.indexOf(t)){for(var s=new Date;-1!=constants.finals.indexOf(getDateString(s));)s.setDate(s.getDate()-1);var a=(new Date).getDate()-s.getDate();finals_p=1==a?constants.finals_p1:2==a?constants.finals_p2:constants.finals_p3,(n=getPeriod(constants.finals_s,constants.finals_e,finals_p)).schedule="Finals"}else(n=getPeriod(constants.standard_s,constants.standard_e,constants.standard_p)).schedule="Standard Schedule";else{for(n.schedule="No school",n.period="!";!(e.getDay()%6)||-1!=constants.holidays.indexOf(t);)e.setDate(e.getDate()+1),t=getDateString(e);n.range="School resumes: "+getDateString(e,"/"),n.end=!1}"!"==n.period[0]?n.period=n.period.substring(1,n.period.length):n.period="Period "+n.period,$("#schedule").text(n.schedule),$("#period").text(n.period),$("#range").text(n.range);var i,r=60*(n.end-minutes-1)+(60-e.getSeconds()),o=function(){i=r%60,$("#timer").text(Math.floor(r/60)+":"+(i<10?"0"+i:i)),r<=0&&(clearInterval(timer),$("#timer").text(""),main()),r--};n.end&&(timer=setInterval(o,1e3),o())}function getPeriod(e,t,n){if(minutes<e[0]||minutes>=t[t.length-1])return{period:"!None",end:!1,range:""};for(var s,a=0;a<e.length;a++)if(minutes>=e[a]&&(s=a,minutes<t[a]))return{period:n[a],end:t[a],range:toHours(e[a])+" - "+toHours(t[a])};return{period:"!Passing",end:e[s+1],range:"Next: "+toHours(e[s+1])+" - "+toHours(t[s+1])}}function getDateString(e){return e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()}function toHours(e){var t=Math.floor(e/60);return t>12&&(t-=12),(e=e%60)<10&&(e="0"+e),t+":"+e}var minutes,timer;$(main),$(window).on("touchend focus",function(){clearInterval(timer),main()});