$(function(){var d=[],f,g="F D- D D+ C- C C+ B- B B+ A- A A+".split(" "),p=function(b,a){var c=parseInt(b.slice(1),16),d=0>a?0:255,k=0>a?-1*a:a,e=c>>16,f=c>>8&255,c=c&255;return"#"+(16777216+65536*(Math.round((d-e)*k)+e)+256*(Math.round((d-f)*k)+f)+(Math.round((d-c)*k)+c)).toString(16).slice(1)},e=constants.colors.slice(0);shuffle(e);var q=e.map(function(b){return p(b,-.2)}),l=e.map(function(b){return p(b,.2)}),w=function(b,a){a&&a.css("background-color",e[e.length-1]);b.each(function(a){$(this).css("background-color",
e[a%e.length]);a=l[a%e.length];$(this).children(".course-level, .final").children(".option").css("background-color",a)})},x=function(b){var a=b.children(".course-level").children(".option").eq(0).outerWidth(),c=b.children(".final").children(".option").eq(0).outerWidth();b.children(".course-level").children(".selected-indicator").css("width",a);b.children(".final").children(".selected-indicator").css("width",c)},m=function(b){var a=b.outerWidth(),c=0;b.prevAll().each(function(){c+=$(this).outerWidth()});
b.siblings(".selected-indicator").css({width:a,transform:"translateX("+c+"px)"})},y=function(){var b=q[$(".gpa-tile").index($(this).parents(".gpa-tile"))%q.length];$(this).css("background-color",b);m($(this))},z=function(){var b=$(".gpa-tile").index($(this).parents(".gpa-tile")),a=l[b%l.length];$(this).css("background-color",a);switch($(this).text()){case "Has Final":$(".gpa-tile").eq(b).children(".grades").children(".term").eq(3).css("display","block");d[b].hasFinal=!0;break;case "No Final":$(".gpa-tile").eq(b).children(".grades").children(".term").eq(3).css("display",
"none");d[b].hasFinal=!1;break;case "Regular":d[b].level=0;break;case "Accelerated":d[b].level=1;break;case "Honors/AP":d[b].level=2}h(b)},A=function(b){var a=$("#grade-options");a.css({display:"none",height:0});var c=$(this).outerHeight(),d=$(this).outerWidth(),e=$(this).offset();a.css("display","inline-block");setTimeout(function(){a.css({top:e.top+c,left:e.left,width:d,height:200})},10);f=$(this);b.stopPropagation()};$("html").on("click touchend",function(){$("#grade-options").css({display:"none",
height:0});f=void 0});$("#grade-options").children().click(function(){if(f){var b=$(this).text();f.children("span").text(b);var a=$(".gpa-tile").index(f.parents(".gpa-tile")),c=$(".gpa-tile").eq(a).children(".grades").find(".grade").index(f);d[a].grades[c]=g.indexOf(b);h(a)}});$("#grade-options").children().on("touchend",function(b){b.stopPropagation()});var B=function(){var b=$(".gpa-tile").index($(this).parent());d.splice(b,1);$(".gpa-tile").eq(b).css("display","none");r()},C=function(){0==$(this).text().indexOf("Course ")&&
$(this).text("")},D=function(){var b=$(".gpa-tile").index($(this).parent());d[b].name=$(this).text();localStorage.courses=JSON.stringify(d)},E=function(){t($(this).parents(".gpa-tile"),-1)},F=function(){t($(this).parents(".gpa-tile"),1)},t=function(b,a){var c=$(".gpa-tile").index(b),e=d[c];e.grades=e.grades.map(function(b){return Math.max(Math.min(b+a,12),0)});h(c);u(e,b)},h=function(b){var a=d[b];var c=a.grades[0]+a.grades[1]+a.grades[2]+(a.hasFinal?a.grades[3]:0);c=a.hasFinal?2>=c?"F":g[Math.round(c/
4)]:g[Math.round(c/3)];var e=function(a){return 0==a};a.hasFinal&&0==a.grades[2]&&0==a.grades[3]?c="F":a.hasFinal&&3<=a.grades.filter(e).length?c="F":!a.hasFinal&&2<=a.grades.filter(e).length&&(c="F");e="F"==c?0:Math.ceil(g.indexOf(c)/3)+a.level/2;a.finalGrade=c;a.finalGPA=e.toFixed(1);$(".gpa-tile").eq(b).children(".final-grade").children("span").text(a.finalGrade);$(".gpa-tile").eq(b).children(".final-gpa").text(a.finalGPA);r()},r=function(){var b=0;d.forEach(function(a){b+=parseFloat(a.finalGPA)});
b/=0==d.length?1:d.length;$(".gpa-head-tile .overall-gpa").text(b.toFixed(2));localStorage.courses=JSON.stringify(d)},u=function(b,a){w($(".gpa-tile"),$(".gpa-head-tile"));a.css("display","flex");x(a);a.children(".name").text(b.name);a.children(".name").attr("contenteditable","true");m(a.children(".course-level").children().eq(b.level));m(a.children(".final").children().eq(b.hasFinal?0:1));a.children(".grades").children(".term").eq(3).css("display",b.hasFinal?"block":"none");a.children(".grades").children(".term").each(function(a){$(this).children(".grade").children("span").text(g[b.grades[a]])});
a.children(".final-grade").children("span").text(b.finalGrade);a.children(".final-gpa").text(b.finalGPA)},v=function(b){d.push(b);var a=$("#sampleGpaTile").clone();a.removeAttr("id");a.addClass("gpa-tile");a.children(".close").click(B);a.children(".name").on("input",D);a.children(".name").click(C);a.children(".course-level,.final").children(".option").on("mousedown touchstart",y);a.children(".course-level,.final").children(".option").on("mouseup touchend",z);a.children(".grades").children(".term").children(".grade").click(A);
a.children(".final-grade").children("i").eq(0).click(E);a.children(".final-grade").children("i").eq(1).click(F);h(d.length-1);$("#tiles").append(a);u(b,a)},n=function(){var b=$(".gpa-tile").length+1;v({name:"Course "+b,level:0,hasFinal:!0,grades:[11,11,11,11],finalGrade:"",finalGPA:""})},G=function(){localStorage.courses&&JSON.parse(localStorage.courses).forEach(function(b){v(b)})};$(".gpa-head-tile .add-course").click(function(){n()});localStorage.courses?G():(n(),n())});
